<!DOCTYPE html><html lang="zh-CN"><head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>v8.getHeapSnapshot() | Node.js API 文档</title>
  
  

    <link href="../../api/static/inject.css" rel="stylesheet"><link rel="icon" sizes="32x32" type="image/png" href="../../api/static/favicon.png"></head>

<body class="alt apidoc" id="page_api_item">
  <div id="api-section-v8">
    <div id="content" class="clearfix">

      <div id="column1" data-id="__ID__" class="interior">
        <header>
          <h1>v8.getHeapSnapshot()</h1>
          <div id="gtoc">
            <ul>
              <li>v16.16.0</li>
              <li>
                <a href="../v8.html#v8_v8_getheapsnapshot" name="toc">返回上层文档</a>
              </li>

              <li class="picker-header">
    <a href="#">
        <span class="collapsed-arrow">►</span><span class="expanded-arrow">▼</span>
        其他版本
      </a>
    <div class="picker"><ol id="alt-docs">
    <li><a href="../../api/v8/v8_getheapsnapshot.html">18.6.0</a></li><li><a href="">16.16.0</a></li><li><a href="../../api-v14/v8/v8_getheapsnapshot.html">14.20.0</a></li>
</ol></div>
  </li>

              <li>
                <a href="http://api.nodejs.cn/" class="link-to-search">搜索</a>
              </li>
              <li>
                
                
              </li>

              <!-- <li>
                <a href="https://github.com/nodejscn/node-api-cn/edit/master/v8/#v8getheapsnapshot.md" rel="nofollow">提交修改</a>
              </li> -->
              <!-- <li>
                <a href="/gzh/">公众号</a>
              </li> -->
              <!-- <li class="biz_wrap" data-biz="api_item_nav">
                <a target="_blank" class="biz_title biz_link"></a>
              </li> -->
            </ul>
          </div>
          <hr>
        </header>

        <div id="apicontent">
          <div id="content_left"><div class="api_metadata">
<span>新增于: v11.13.0</span>
</div><ul class="">
<li>返回: <a href="../stream.html#class-streamreadable" rel="nofollow" class="type">&lt;stream.Readable&gt;</a> 包含 V8 堆快照的可读流</li>
</ul><p>生成当前 V8 堆的快照并返回可用于读取 JSON 序列化表示的可读流。
此 JSON 流格式旨在与 Chrome 开发者工具等工具一起使用。
JSON 模式未记录并且特定于 V8 引擎。
因此，模式可能会从 V8 的一个版本更改为下一个版本。</p><p class="">创建堆快照需要的内存大约是创建快照时堆大小的两倍。
这会导致 OOM 杀手终止进程的风险。</p><p class="">生成快照是一个同步的操作，它会根据堆大小在一段时间内阻塞事件循环。</p><pre class=""><code class="language-js"><span class="hljs-comment">// 打印堆快照到控制台</span>
<span class="hljs-keyword">const</span> v8 = <span class="hljs-built_in">require</span>(<span class="hljs-string">'v8'</span>);
<span class="hljs-keyword">const</span> stream = v8.<span class="hljs-title function_">getHeapSnapshot</span>();
stream.<span class="hljs-title function_">pipe</span>(process.<span class="hljs-property">stdout</span>);</code></pre></div>
          <div id="content_right"><div class="api_metadata">
<span>Added in: v11.13.0</span>
</div><ul>
<li>Returns: <a href="../stream.html#class-streamreadable" rel="nofollow" class="type">&lt;stream.Readable&gt;</a> A Readable Stream containing the V8 heap snapshot</li>
</ul><p>Generates a snapshot of the current V8 heap and returns a Readable
Stream that may be used to read the JSON serialized representation.
This JSON stream format is intended to be used with tools such as
Chrome DevTools. The JSON schema is undocumented and specific to the
V8 engine. Therefore, the schema may change from one version of V8 to the next.</p><p>Creating a heap snapshot requires memory about twice the size of the heap at
the time the snapshot is created. This results in the risk of OOM killers
terminating the process.</p><p>Generating a snapshot is a synchronous operation which blocks the event loop
for a duration depending on the heap size.</p><pre><code class="language-js"><span class="hljs-comment">// Print heap snapshot to the console</span>
<span class="hljs-keyword">const</span> v8 = <span class="hljs-built_in">require</span>(<span class="hljs-string">'v8'</span>);
<span class="hljs-keyword">const</span> stream = v8.<span class="hljs-title function_">getHeapSnapshot</span>();
stream.<span class="hljs-title function_">pipe</span>(process.<span class="hljs-property">stdout</span>);</code></pre></div>
          <div></div>
        </div>

        <!-- <div id="biz_item" class="biz_wrap" data-biz="api_item">
          <a target="_blank" class="biz_link">
            <img class="biz_img" />
          </a>
        </div> -->
      </div>
    </div>
  </div>
  
  <div id="wxpaycode_box" style="display: none;">
    <div id="wxpaycode_img_box">
      <div id="wxpaycode_vip_tips">
        因经营维护成本巨大，
        <br>为了能提供更高质量的中文文档，
        <br>即日起将只对VIP会员开放。
        <br>扫码成为VIP会员，会员费用为<span id="wxpaycode_vip_money">199</span>元/年
      </div>
      <img id="wxpaycode_img">
    </div>
  </div>
  
  
  



    <script src="../../api/static/inject.js" defer=""></script></body></html>