<!DOCTYPE html><html lang="zh-CN"><head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>UV_THREADPOOL_SIZE=size | Node.js API 文档</title>
  
  

    <link href="../../api/static/inject.css" rel="stylesheet"><link rel="icon" sizes="32x32" type="image/png" href="../../api/static/favicon.png"></head>

<body class="alt apidoc" id="page_api_item">
  <div id="api-section-cli">
    <div id="content" class="clearfix">

      <div id="column1" data-id="__ID__" class="interior">
        <header>
          <h1>UV_THREADPOOL_SIZE=size</h1>
          <div id="gtoc">
            <ul>
              <li>v16.16.0</li>
              <li>
                <a href="../cli.html#cli_uv_threadpool_size_size" name="toc">返回上层文档</a>
              </li>

              <li class="picker-header">
    <a href="#">
        <span class="collapsed-arrow">►</span><span class="expanded-arrow">▼</span>
        其他版本
      </a>
    <div class="picker"><ol id="alt-docs">
    <li><a href="../../api/cli/uv_threadpool_size_size.html">18.6.0</a></li><li><a href="">16.16.0</a></li><li><a href="../../api-v14/cli/uv_threadpool_size_size.html">14.20.0</a></li>
</ol></div>
  </li>

              <li>
                <a href="http://api.nodejs.cn/" class="link-to-search">搜索</a>
              </li>
              <li>
                
                
              </li>

              <!-- <li>
                <a href="https://github.com/nodejscn/node-api-cn/edit/master/cli/#uv_threadpool_sizesize.md" rel="nofollow">提交修改</a>
              </li> -->
              <!-- <li>
                <a href="/gzh/">公众号</a>
              </li> -->
              <!-- <li class="biz_wrap" data-biz="api_item_nav">
                <a target="_blank" class="biz_title biz_link"></a>
              </li> -->
            </ul>
          </div>
          <hr>
        </header>

        <div id="apicontent">
          <div id="content_left"><p>将 libuv 的线程池中使用的线程数设置为 <code>size</code> 个线程。</p><p class="">Node.js 尽可能使用异步的系统 API，但在它们不存在的情况下，libuv 的线程池用于基于同步的系统 API 创建异步的 node API。
使用线程池的 Node.js API 有：</p><ul class="">
<li>所有 <code>fs</code> API，除了文件监视器 API 和那些显式同步的</li>
<li>异步加密 API，例如 <code>crypto.pbkdf2()</code>、<code>crypto.scrypt()</code>、<code>crypto.randomBytes()</code>、<code>crypto.randomFill()</code>、<code>crypto.generateKeyPair()</code></li>
<li><code>dns.lookup()</code></li>
<li>所有 <code>zlib</code> API，除了那些显式同步的</li>
</ul><p class="">因为 libuv 的线程池有固定的大小，这意味着如果这些 API 中的任何一个由于某种原因需要很长时间，则在 libuv 的线程池中运行的其他（看似无关的）API 的性能将会下降。
为了缓解此问题，潜在的解决方案是通过将 <code>'UV_THREADPOOL_SIZE'</code> 环境变量设置为大于 <code>4</code>（其当前默认值）的值来增加 libuv 线程池的大小。
有关更多信息，请参阅 <a href="https://docs.libuv.org/en/latest/threadpool.html" rel="nofollow">libuv 线程池文档</a>。</p></div>
          <div id="content_right"><p>Set the number of threads used in libuv's threadpool to <code>size</code> threads.</p><p>Asynchronous system APIs are used by Node.js whenever possible, but where they
do not exist, libuv's threadpool is used to create asynchronous node APIs based
on synchronous system APIs. Node.js APIs that use the threadpool are:</p><ul>
<li>all <code>fs</code> APIs, other than the file watcher APIs and those that are explicitly
synchronous</li>
<li>asynchronous crypto APIs such as <code>crypto.pbkdf2()</code>, <code>crypto.scrypt()</code>,
<code>crypto.randomBytes()</code>, <code>crypto.randomFill()</code>, <code>crypto.generateKeyPair()</code></li>
<li><code>dns.lookup()</code></li>
<li>all <code>zlib</code> APIs, other than those that are explicitly synchronous</li>
</ul><p>Because libuv's threadpool has a fixed size, it means that if for whatever
reason any of these APIs takes a long time, other (seemingly unrelated) APIs
that run in libuv's threadpool will experience degraded performance. In order to
mitigate this issue, one potential solution is to increase the size of libuv's
threadpool by setting the <code>'UV_THREADPOOL_SIZE'</code> environment variable to a value
greater than <code>4</code> (its current default value). For more information, see the
<a href="https://docs.libuv.org/en/latest/threadpool.html" rel="nofollow">libuv threadpool documentation</a>.</p></div>
          <div></div>
        </div>

        <!-- <div id="biz_item" class="biz_wrap" data-biz="api_item">
          <a target="_blank" class="biz_link">
            <img class="biz_img" />
          </a>
        </div> -->
      </div>
    </div>
  </div>
  
  <div id="wxpaycode_box" style="display: none;">
    <div id="wxpaycode_img_box">
      <div id="wxpaycode_vip_tips">
        因经营维护成本巨大，
        <br>为了能提供更高质量的中文文档，
        <br>即日起将只对VIP会员开放。
        <br>扫码成为VIP会员，会员费用为<span id="wxpaycode_vip_money">199</span>元/年
      </div>
      <img id="wxpaycode_img">
    </div>
  </div>
  
  
  



    <script src="../../api/static/inject.js" defer=""></script></body></html>