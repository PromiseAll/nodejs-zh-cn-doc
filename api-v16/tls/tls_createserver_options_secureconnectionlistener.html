<!DOCTYPE html><html lang="zh-CN"><head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>tls.createServer([options][, secureConnectionListener]) | Node.js API 文档</title>
  
  

    <link href="../../api/static/inject.css" rel="stylesheet"><link rel="icon" sizes="32x32" type="image/png" href="../../api/static/favicon.png"></head>

<body class="alt apidoc" id="page_api_item">
  <div id="api-section-tls">
    <div id="content" class="clearfix">

      <div id="column1" data-id="__ID__" class="interior">
        <header>
          <h1>tls.createServer([options][, secureConnectionListener])</h1>
          <div id="gtoc">
            <ul>
              <li>v16.16.0</li>
              <li>
                <a href="../tls.html#tls_tls_createserver_options_secureconnectionlistener" name="toc">返回上层文档</a>
              </li>

              <li class="picker-header">
    <a href="#">
        <span class="collapsed-arrow">►</span><span class="expanded-arrow">▼</span>
        其他版本
      </a>
    <div class="picker"><ol id="alt-docs">
    <li><a href="../../api/tls/tls_createserver_options_secureconnectionlistener.html">18.6.0</a></li><li><a href="">16.16.0</a></li><li><a href="../../api-v14/tls/tls_createserver_options_secureconnectionlistener.html">14.20.0</a></li>
</ol></div>
  </li>

              <li>
                <a href="http://api.nodejs.cn/" class="link-to-search">搜索</a>
              </li>
              <li>
                
                
              </li>

              <!-- <li>
                <a href="https://github.com/nodejscn/node-api-cn/edit/master/tls/#tlscreateserveroptions-secureconnectionlistener.md" rel="nofollow">提交修改</a>
              </li> -->
              <!-- <li>
                <a href="/gzh/">公众号</a>
              </li> -->
              <!-- <li class="biz_wrap" data-biz="api_item_nav">
                <a target="_blank" class="biz_title biz_link"></a>
              </li> -->
            </ul>
          </div>
          <hr>
        </header>

        <div id="apicontent">
          <div id="content_left"><div class="api_metadata">
<details class="changelog" open=""><summary>版本历史</summary>
<table>
<tbody><tr><th>版本</th><th>变更</th></tr>
<tr><td>v12.3.0</td>
<td><p>参数 <code>options</code> 现在支持 <code>net.createServer()</code> 选项。</p></td></tr>
<tr><td>v9.3.0</td>
<td><p>参数 <code>options</code> 现在可以包含 <code>clientCertEngine</code>。</p></td></tr>
<tr><td>v8.0.0</td>
<td><p>选项 <code>ALPNProtocols</code> 现在可以是 <code>TypedArray</code> 或 <code>DataView</code>。</p></td></tr>
<tr><td>v5.0.0</td>
<td><p>现在支持 ALPN 选项。</p></td></tr>
<tr><td>v0.3.2</td>
<td><p><span>新增于: v0.3.2</span></p></td></tr>
</tbody></table>
</details>
</div><ul class="">
<li><code>options</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" rel="nofollow" class="type">&lt;Object&gt;</a>
<ul>
<li>
<p><code>ALPNProtocols</code>: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" rel="nofollow" class="type">&lt;string[]&gt;</a> | <a href="../buffer.html#class-buffer" rel="nofollow" class="type">&lt;Buffer[]&gt;</a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray" rel="nofollow" class="type">&lt;TypedArray[]&gt;</a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView" rel="nofollow" class="type">&lt;DataView[]&gt;</a> | <a href="../buffer.html#class-buffer" rel="nofollow" class="type">&lt;Buffer&gt;</a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray" rel="nofollow" class="type">&lt;TypedArray&gt;</a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView" rel="nofollow" class="type">&lt;DataView&gt;</a> 字符串数组、<code>Buffer</code>、或 <code>TypedArray</code>、或 <code>DataView</code>、或包含支持的 ALPN 协议的单个 <code>Buffer</code> 或 <code>TypedArray</code> 或 <code>DataView</code>。
<code>Buffer</code> 的格式应该是 <code>[len][name][len][name]...</code>，例如 <code>0x05hello0x05world</code>，其中第一个字节是下一个协议名称的长度。
传入数组通常要简单得多，例如 <code>['hello', 'world']</code>。
（协议应按优先级排序。）</p>
</li>
<li>
<p><code>clientCertEngine</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" rel="nofollow" class="type">&lt;string&gt;</a> 可以提供客户端证书的 OpenSSL 引擎的名称。</p>
</li>
<li>
<p><code>enableTrace</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type" rel="nofollow" class="type">&lt;boolean&gt;</a> 如果为 <code>true</code>, 则 <a href="../tls.html#tlssocketenabletrace"><code>tls.TLSSocket.enableTrace()</code></a> 将在新连接上调用。
建立安全连接后可以启用跟踪，但必须使用此选项来跟踪安全连接设置。 <strong>默认值:</strong> <code>false</code>。</p>
</li>
<li>
<p><code>handshakeTimeout</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" rel="nofollow" class="type">&lt;number&gt;</a> 如果 SSL/TLS 握手未在指定的毫秒数内完成，则中止连接。
每当握手超时时，<code>tls.Server</code> 对象上就会触发 <code>'tlsClientError'</code>。 <strong>默认值:</strong> <code>120000</code> （120 秒）。</p>
</li>
<li>
<p><code>rejectUnauthorized</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type" rel="nofollow" class="type">&lt;boolean&gt;</a> 如果不是 <code>false</code>，则服务器将拒绝任何未经提供的 CA 列表授权的连接。
此选项仅在 <code>requestCert</code> 为 <code>true</code> 时有效。 <strong>默认值:</strong> <code>true</code>。</p>
</li>
<li>
<p><code>requestCert</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type" rel="nofollow" class="type">&lt;boolean&gt;</a> 如果为 <code>true</code>，则服务器将从连接的客户端请求证书并尝试验证该证书。 <strong>默认值:</strong> <code>false</code>。</p>
</li>
<li>
<p><code>sessionTimeout</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" rel="nofollow" class="type">&lt;number&gt;</a> 服务器创建的 TLS 会话将无法恢复之前的秒数。
请参阅<a href="../tls.html#session-resumption">会话恢复</a>了解更多信息。 <strong>默认值:</strong> <code>300</code>。</p>
</li>
<li>
<p><code>SNICallback(servername, callback)</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" rel="nofollow" class="type">&lt;Function&gt;</a> 如果客户端支持 SNI TLS 扩展，将调用的函数。
调用时将传入两个参数：<code>servername</code> 和 <code>callback</code>。
<code>callback</code> 是错误优先的回调，它有两个可选参数：<code>error</code> 和 <code>ctx</code>。
<code>ctx</code> 是 <code>SecureContext</code> 实例（如果提供）。
<a href="../tls.html#tlscreatesecurecontextoptions"><code>tls.createSecureContext()</code></a> 可用于获得正确的 <code>SecureContext</code>。
如果使用非真的 <code>ctx</code> 参数调用 <code>callback</code>，则将使用服务器的默认安全上下文。
如果未提供 <code>SNICallback</code>，则将使用具有高级 API 的默认回调（见下文）。</p>
</li>
<li>
<p><code>ticketKeys</code>: <a href="../buffer.html#class-buffer" rel="nofollow" class="type">&lt;Buffer&gt;</a> 48 字节的加密强伪随机数据。
请参阅<a href="../tls.html#session-resumption">会话恢复</a>了解更多信息。</p>
</li>
<li>
<p><code>pskCallback</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" rel="nofollow" class="type">&lt;Function&gt;</a></p>
<p>socket: <a href="../tls.html#class-tlstlssocket" rel="nofollow" class="type">&lt;tls.TLSSocket&gt;</a> 此连接的服务器 <a href="../tls.html#class-tlstlssocket"><code>tls.TLSSocket</code></a> 实例。</p>
<ul>
<li>identity: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" rel="nofollow" class="type">&lt;string&gt;</a> 客户端发送的身份参数。</li>
<li>返回: <a href="../buffer.html#class-buffer" rel="nofollow" class="type">&lt;Buffer&gt;</a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray" rel="nofollow" class="type">&lt;TypedArray&gt;</a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView" rel="nofollow" class="type">&lt;DataView&gt;</a> 预共享密钥必须是缓冲区或 <code>null</code> 才能停止协商过程。
返回的 PSK 必须与所选密码的摘要兼容。</li>
</ul>
<p>当协商 TLS-PSK（预共享密钥）时，使用客户端提供的身份调用此函数。
如果返回值为 <code>null</code>，则协商过程将停止，并向对方发送 "unknown_psk_identity" 警告消息。
如果服务器希望隐藏 PSK 身份未知的事实，则回调必须提供一些随机数据作为 <code>psk</code> 以使连接失败并在协商完成之前出现 "decrypt_error"。
默认情况下禁用 PSK 密码，因此使用 TLS-PSK 需要使用 <code>ciphers</code> 选项明确指定密码套件。
可以在 <a href="https://tools.ietf.org/html/rfc4279" rel="nofollow">RFC 4279</a> 中找到更多信息。</p>
</li>
<li>
<p><code>pskIdentityHint</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" rel="nofollow" class="type">&lt;string&gt;</a> 发送给客户端的可选提示，以帮助在 TLS-PSK 协商期间选择身份。
将在 TLS 1.3 中被忽略。设置 pskIdentityHint 失败时，<code>'tlsClientError'</code> 将与 <code>'ERR_TLS_PSK_SET_IDENTIY_HINT_FAILED'</code> 代码一起触发。</p>
</li>
<li>
<p>...: 可以提供任何 <a href="../tls.html#tlscreatesecurecontextoptions"><code>tls.createSecureContext()</code></a> 选项。
对于服务器，通常需要身份选项（<code>pfx</code>、<code>key</code>/<code>cert</code> 或 <code>pskCallback</code>）。</p>
</li>
<li>
<p>...: 可以提供任何 <a href="../net.html#netcreateserveroptions-connectionlistener"><code>net.createServer()</code></a> 选项。</p>
</li>
</ul>
</li>
<li><code>secureConnectionListener</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" rel="nofollow" class="type">&lt;Function&gt;</a></li>
<li>返回: <a href="../tls.html#class-tlsserver" rel="nofollow" class="type">&lt;tls.Server&gt;</a></li>
</ul><p>创建新的 <a href="../tls.html#class-tlsserver"><code>tls.Server</code></a>。
<code>secureConnectionListener</code>，如果提供，将自动设置为 <a href="../tls.html#event-secureconnection"><code>'secureConnection'</code></a> 事件的监听器。</p><p class=""><code>ticketKeys</code> 选项在 <code>cluster</code> 模块工作器之间自动共享。</p><p class="">以下说明了一个简单的回显服务器：</p><pre class=""><code class="language-js"><span class="hljs-keyword">const</span> tls = <span class="hljs-built_in">require</span>(<span class="hljs-string">'tls'</span>);
<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);

<span class="hljs-keyword">const</span> options = {
  <span class="hljs-attr">key</span>: fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">'server-key.pem'</span>),
  <span class="hljs-attr">cert</span>: fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">'server-cert.pem'</span>),

  <span class="hljs-comment">// 这仅在使用客户端证书身份验证时才需要。</span>
  <span class="hljs-attr">requestCert</span>: <span class="hljs-literal">true</span>,

  <span class="hljs-comment">// 仅当客户端使用自签名证书时才需要这样做。</span>
  <span class="hljs-attr">ca</span>: [ fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">'client-cert.pem'</span>) ]
};

<span class="hljs-keyword">const</span> server = tls.<span class="hljs-title function_">createServer</span>(options, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'server connected'</span>,
              socket.<span class="hljs-property">authorized</span> ? <span class="hljs-string">'authorized'</span> : <span class="hljs-string">'unauthorized'</span>);
  socket.<span class="hljs-title function_">write</span>(<span class="hljs-string">'welcome!\n'</span>);
  socket.<span class="hljs-title function_">setEncoding</span>(<span class="hljs-string">'utf8'</span>);
  socket.<span class="hljs-title function_">pipe</span>(socket);
});
server.<span class="hljs-title function_">listen</span>(<span class="hljs-number">8000</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'server bound'</span>);
});</code></pre><p class="">可以通过使用 <a href="../tls.html#tlsconnectoptions-callback"><code>tls.connect()</code></a> 的示例客户端连接到服务器来测试服务器。</p></div>
          <div id="content_right"><div class="api_metadata">
<details class="changelog" open=""><summary>History</summary>
<table>
<tbody><tr><th>Version</th><th>Changes</th></tr>
<tr><td>v12.3.0</td>
<td><p>The <code>options</code> parameter now supports <code>net.createServer()</code> options.</p></td></tr>
<tr><td>v9.3.0</td>
<td><p>The <code>options</code> parameter can now include <code>clientCertEngine</code>.</p></td></tr>
<tr><td>v8.0.0</td>
<td><p>The <code>ALPNProtocols</code> option can be a <code>TypedArray</code> or <code>DataView</code> now.</p></td></tr>
<tr><td>v5.0.0</td>
<td><p>ALPN options are supported now.</p></td></tr>
<tr><td>v0.3.2</td>
<td><p><span>Added in: v0.3.2</span></p></td></tr>
</tbody></table>
</details>
</div><ul>
<li><code>options</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" rel="nofollow" class="type">&lt;Object&gt;</a>
<ul>
<li>
<p><code>ALPNProtocols</code>: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" rel="nofollow" class="type">&lt;string[]&gt;</a> | <a href="../buffer.html#class-buffer" rel="nofollow" class="type">&lt;Buffer[]&gt;</a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray" rel="nofollow" class="type">&lt;TypedArray[]&gt;</a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView" rel="nofollow" class="type">&lt;DataView[]&gt;</a> | <a href="../buffer.html#class-buffer" rel="nofollow" class="type">&lt;Buffer&gt;</a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray" rel="nofollow" class="type">&lt;TypedArray&gt;</a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView" rel="nofollow" class="type">&lt;DataView&gt;</a>
An array of strings, <code>Buffer</code>s or <code>TypedArray</code>s or <code>DataView</code>s, or a single
<code>Buffer</code> or <code>TypedArray</code> or <code>DataView</code> containing the supported ALPN
protocols. <code>Buffer</code>s should have the format <code>[len][name][len][name]...</code>
e.g. <code>0x05hello0x05world</code>, where the first byte is the length of the next
protocol name. Passing an array is usually much simpler, e.g.
<code>['hello', 'world']</code>. (Protocols should be ordered by their priority.)</p>
</li>
<li>
<p><code>clientCertEngine</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" rel="nofollow" class="type">&lt;string&gt;</a> Name of an OpenSSL engine which can provide the
client certificate.</p>
</li>
<li>
<p><code>enableTrace</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type" rel="nofollow" class="type">&lt;boolean&gt;</a> If <code>true</code>, <a href="../tls.html#tlssocketenabletrace"><code>tls.TLSSocket.enableTrace()</code></a> will be
called on new connections. Tracing can be enabled after the secure
connection is established, but this option must be used to trace the secure
connection setup. <strong>Default:</strong> <code>false</code>.</p>
</li>
<li>
<p><code>handshakeTimeout</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" rel="nofollow" class="type">&lt;number&gt;</a> Abort the connection if the SSL/TLS handshake
does not finish in the specified number of milliseconds.
A <code>'tlsClientError'</code> is emitted on the <code>tls.Server</code> object whenever
a handshake times out. <strong>Default:</strong> <code>120000</code> (120 seconds).</p>
</li>
<li>
<p><code>rejectUnauthorized</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type" rel="nofollow" class="type">&lt;boolean&gt;</a> If not <code>false</code> the server will reject any
connection which is not authorized with the list of supplied CAs. This
option only has an effect if <code>requestCert</code> is <code>true</code>. <strong>Default:</strong> <code>true</code>.</p>
</li>
<li>
<p><code>requestCert</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type" rel="nofollow" class="type">&lt;boolean&gt;</a> If <code>true</code> the server will request a certificate from
clients that connect and attempt to verify that certificate. <strong>Default:</strong>
<code>false</code>.</p>
</li>
<li>
<p><code>sessionTimeout</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" rel="nofollow" class="type">&lt;number&gt;</a> The number of seconds after which a TLS session
created by the server will no longer be resumable. See
<a href="../tls.html#session-resumption">Session Resumption</a> for more information. <strong>Default:</strong> <code>300</code>.</p>
</li>
<li>
<p><code>SNICallback(servername, callback)</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" rel="nofollow" class="type">&lt;Function&gt;</a> A function that will be
called if the client supports SNI TLS extension. Two arguments will be
passed when called: <code>servername</code> and <code>callback</code>. <code>callback</code> is an
error-first callback that takes two optional arguments: <code>error</code> and <code>ctx</code>.
<code>ctx</code>, if provided, is a <code>SecureContext</code> instance.
<a href="../tls.html#tlscreatesecurecontextoptions"><code>tls.createSecureContext()</code></a> can be used to get a proper <code>SecureContext</code>.
If <code>callback</code> is called with a falsy <code>ctx</code> argument, the default secure
context of the server will be used. If <code>SNICallback</code> wasn't provided the
default callback with high-level API will be used (see below).</p>
</li>
<li>
<p><code>ticketKeys</code>: <a href="../buffer.html#class-buffer" rel="nofollow" class="type">&lt;Buffer&gt;</a> 48-bytes of cryptographically strong pseudorandom
data. See <a href="../tls.html#session-resumption">Session Resumption</a> for more information.</p>
</li>
<li>
<p><code>pskCallback</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" rel="nofollow" class="type">&lt;Function&gt;</a></p>
<ul>
<li>socket: <a href="../tls.html#class-tlstlssocket" rel="nofollow" class="type">&lt;tls.TLSSocket&gt;</a> the server <a href="../tls.html#class-tlstlssocket"><code>tls.TLSSocket</code></a> instance for
this connection.</li>
<li>identity: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" rel="nofollow" class="type">&lt;string&gt;</a> identity parameter sent from the client.</li>
<li>Returns: <a href="../buffer.html#class-buffer" rel="nofollow" class="type">&lt;Buffer&gt;</a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray" rel="nofollow" class="type">&lt;TypedArray&gt;</a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView" rel="nofollow" class="type">&lt;DataView&gt;</a> pre-shared key that must either be
a buffer or <code>null</code> to stop the negotiation process. Returned PSK must be
compatible with the selected cipher's digest.</li>
</ul>
<p>When negotiating TLS-PSK (pre-shared keys), this function is called
with the identity provided by the client.
If the return value is <code>null</code> the negotiation process will stop and an
"unknown_psk_identity" alert message will be sent to the other party.
If the server wishes to hide the fact that the PSK identity was not known,
the callback must provide some random data as <code>psk</code> to make the connection
fail with "decrypt_error" before negotiation is finished.
PSK ciphers are disabled by default, and using TLS-PSK thus
requires explicitly specifying a cipher suite with the <code>ciphers</code> option.
More information can be found in the <a href="https://tools.ietf.org/html/rfc4279" rel="nofollow">RFC 4279</a>.</p>
</li>
<li>
<p><code>pskIdentityHint</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" rel="nofollow" class="type">&lt;string&gt;</a> optional hint to send to a client to help
with selecting the identity during TLS-PSK negotiation. Will be ignored
in TLS 1.3. Upon failing to set pskIdentityHint <code>'tlsClientError'</code> will be
emitted with <code>'ERR_TLS_PSK_SET_IDENTIY_HINT_FAILED'</code> code.</p>
</li>
<li>
<p>...: Any <a href="../tls.html#tlscreatesecurecontextoptions"><code>tls.createSecureContext()</code></a> option can be provided. For
servers, the identity options (<code>pfx</code>, <code>key</code>/<code>cert</code> or <code>pskCallback</code>)
are usually required.</p>
</li>
<li>
<p>...: Any <a href="../net.html#netcreateserveroptions-connectionlistener"><code>net.createServer()</code></a> option can be provided.</p>
</li>
</ul>
</li>
<li><code>secureConnectionListener</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" rel="nofollow" class="type">&lt;Function&gt;</a></li>
<li>Returns: <a href="../tls.html#class-tlsserver" rel="nofollow" class="type">&lt;tls.Server&gt;</a></li>
</ul><p>Creates a new <a href="../tls.html#class-tlsserver"><code>tls.Server</code></a>. The <code>secureConnectionListener</code>, if provided, is
automatically set as a listener for the <a href="../tls.html#event-secureconnection"><code>'secureConnection'</code></a> event.</p><p>The <code>ticketKeys</code> options is automatically shared between <code>cluster</code> module
workers.</p><p>The following illustrates a simple echo server:</p><pre><code class="language-js"><span class="hljs-keyword">const</span> tls = <span class="hljs-built_in">require</span>(<span class="hljs-string">'tls'</span>);
<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);

<span class="hljs-keyword">const</span> options = {
  <span class="hljs-attr">key</span>: fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">'server-key.pem'</span>),
  <span class="hljs-attr">cert</span>: fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">'server-cert.pem'</span>),

  <span class="hljs-comment">// This is necessary only if using client certificate authentication.</span>
  <span class="hljs-attr">requestCert</span>: <span class="hljs-literal">true</span>,

  <span class="hljs-comment">// This is necessary only if the client uses a self-signed certificate.</span>
  <span class="hljs-attr">ca</span>: [ fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">'client-cert.pem'</span>) ]
};

<span class="hljs-keyword">const</span> server = tls.<span class="hljs-title function_">createServer</span>(options, <span class="hljs-function">(<span class="hljs-params">socket</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'server connected'</span>,
              socket.<span class="hljs-property">authorized</span> ? <span class="hljs-string">'authorized'</span> : <span class="hljs-string">'unauthorized'</span>);
  socket.<span class="hljs-title function_">write</span>(<span class="hljs-string">'welcome!\n'</span>);
  socket.<span class="hljs-title function_">setEncoding</span>(<span class="hljs-string">'utf8'</span>);
  socket.<span class="hljs-title function_">pipe</span>(socket);
});
server.<span class="hljs-title function_">listen</span>(<span class="hljs-number">8000</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'server bound'</span>);
});</code></pre><p>The server can be tested by connecting to it using the example client from
<a href="../tls.html#tlsconnectoptions-callback"><code>tls.connect()</code></a>.</p></div>
          <div></div>
        </div>

        <!-- <div id="biz_item" class="biz_wrap" data-biz="api_item">
          <a target="_blank" class="biz_link">
            <img class="biz_img" />
          </a>
        </div> -->
      </div>
    </div>
  </div>
  
  <div id="wxpaycode_box" style="display: none;">
    <div id="wxpaycode_img_box">
      <div id="wxpaycode_vip_tips">
        因经营维护成本巨大，
        <br>为了能提供更高质量的中文文档，
        <br>即日起将只对VIP会员开放。
        <br>扫码成为VIP会员，会员费用为<span id="wxpaycode_vip_money">199</span>元/年
      </div>
      <img id="wxpaycode_img">
    </div>
  </div>
  
  
  



    <script src="../../api/static/inject.js" defer=""></script></body></html>