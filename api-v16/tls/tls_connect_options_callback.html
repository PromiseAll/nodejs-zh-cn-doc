<!DOCTYPE html><html lang="zh-CN"><head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>tls.connect(options[, callback]) | Node.js API 文档</title>
  
  

    <link href="../../api/static/inject.css" rel="stylesheet"><link rel="icon" sizes="32x32" type="image/png" href="../../api/static/favicon.png"></head>

<body class="alt apidoc" id="page_api_item">
  <div id="api-section-tls">
    <div id="content" class="clearfix">

      <div id="column1" data-id="__ID__" class="interior">
        <header>
          <h1>tls.connect(options[, callback])</h1>
          <div id="gtoc">
            <ul>
              <li>v16.16.0</li>
              <li>
                <a href="../tls.html#tls_tls_connect_options_callback" name="toc">返回上层文档</a>
              </li>

              <li class="picker-header">
    <a href="#">
        <span class="collapsed-arrow">►</span><span class="expanded-arrow">▼</span>
        其他版本
      </a>
    <div class="picker"><ol id="alt-docs">
    <li><a href="../../api/tls/tls_connect_options_callback.html">18.6.0</a></li><li><a href="">16.16.0</a></li><li><a href="../../api-v14/tls/tls_connect_options_callback.html">14.20.0</a></li>
</ol></div>
  </li>

              <li>
                <a href="http://api.nodejs.cn/" class="link-to-search">搜索</a>
              </li>
              <li>
                
                
              </li>

              <!-- <li>
                <a href="https://github.com/nodejscn/node-api-cn/edit/master/tls/#tlsconnectoptions-callback.md" rel="nofollow">提交修改</a>
              </li> -->
              <!-- <li>
                <a href="/gzh/">公众号</a>
              </li> -->
              <!-- <li class="biz_wrap" data-biz="api_item_nav">
                <a target="_blank" class="biz_title biz_link"></a>
              </li> -->
            </ul>
          </div>
          <hr>
        </header>

        <div id="apicontent">
          <div id="content_left"><div class="api_metadata">
<details class="changelog" open=""><summary>版本历史</summary>
<table>
<tbody><tr><th>版本</th><th>变更</th></tr>
<tr><td>v15.1.0</td>
<td><p>添加了 <code>onread</code> 选项。</p></td></tr>
<tr><td>v14.1.0, v13.14.0</td>
<td><p>现在接受 <code>highWaterMark</code> 选项。</p></td></tr>
<tr><td>v13.6.0, v12.16.0</td>
<td><p>现在支持 <code>pskCallback</code> 选项。</p></td></tr>
<tr><td>v12.9.0</td>
<td><p>支持 <code>allowHalfOpen</code> 选项。</p></td></tr>
<tr><td>v12.4.0</td>
<td><p>现在支持 <code>hints</code> 选项。</p></td></tr>
<tr><td>v12.2.0</td>
<td><p>现在支持 <code>enableTrace</code> 选项。</p></td></tr>
<tr><td>v11.8.0, v10.16.0</td>
<td><p>现在支持 <code>timeout</code> 选项。</p></td></tr>
<tr><td>v8.0.0</td>
<td><p>现在支持 <code>lookup</code> 选项。</p></td></tr>
<tr><td>v8.0.0</td>
<td><p>选项 <code>ALPNProtocols</code> 现在可以是 <code>TypedArray</code> 或 <code>DataView</code>。</p></td></tr>
<tr><td>v5.0.0</td>
<td><p>现在支持 ALPN 选项。</p></td></tr>
<tr><td>v5.3.0, v4.7.0</td>
<td><p>现在支持 <code>secureContext</code> 选项。</p></td></tr>
<tr><td>v0.11.3</td>
<td><p><span>新增于: v0.11.3</span></p></td></tr>
</tbody></table>
</details>
</div><ul class="">
<li><code>options</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" rel="nofollow" class="type">&lt;Object&gt;</a>
<ul>
<li>
<p><code>enableTrace</code>: 参见 <a href="../tls.html#tlscreateserveroptions-secureconnectionlistener"><code>tls.createServer()</code></a></p>
</li>
<li>
<p><code>host</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" rel="nofollow" class="type">&lt;string&gt;</a> 客户端应该连接到的主机。 <strong>默认值:</strong> <code>'localhost'</code>。</p>
</li>
<li>
<p><code>port</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" rel="nofollow" class="type">&lt;number&gt;</a> 客户端应该连接到的端口。</p>
</li>
<li>
<p><code>path</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" rel="nofollow" class="type">&lt;string&gt;</a> 创建到路径的 Unix 套接字连接。
如果指定了此选项，则 <code>host</code> 和 <code>port</code> 将被忽略。</p>
</li>
<li>
<p><code>socket</code> <a href="../stream.html#class-streamduplex" rel="nofollow" class="type">&lt;stream.Duplex&gt;</a> 在给定的套接字上建立安全连接而不是创建新的套接字。
通常，这是 <a href="../net.html#class-netsocket"><code>net.Socket</code></a> 的实例，但允许任何 <code>Duplex</code> 流。
如果指定了此选项，则 <code>path</code>、<code>host</code> 和 <code>port</code> 将被忽略，除了证书验证。
通常，套接字在传给 <code>tls.connect()</code> 的时候就已经连接上了，但是可以稍后再连接。
<code>socket</code> 的连接/断开/销毁是用户的责任；调用 <code>tls.connect()</code> 不会导致调用 <code>net.connect()</code>。</p>
</li>
<li>
<p><code>allowHalfOpen</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type" rel="nofollow" class="type">&lt;boolean&gt;</a> 如果设置为 <code>false</code>，则当可读端结束时，套接字将自动结束可写端。
如果设置了 <code>socket</code> 选项，则该选项无效。
详见 <a href="../net.html#class-netsocket"><code>net.Socket</code></a> 的 <code>allowHalfOpen</code> 选项。 <strong>默认值:</strong> <code>false</code>。</p>
</li>
<li>
<p><code>rejectUnauthorized</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type" rel="nofollow" class="type">&lt;boolean&gt;</a> 如果不是 <code>false</code>，则服务器证书将根据提供的 CA 列表进行验证。
如果验证失败，则会触发 <code>'error'</code> 事件；<code>err.code</code> 包含 OpenSSL 错误代码。 <strong>默认值:</strong> <code>true</code>。</p>
</li>
<li>
<p><code>pskCallback</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" rel="nofollow" class="type">&lt;Function&gt;</a></p>
<ul>
<li>提示：从服务器发送的 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" rel="nofollow" class="type">&lt;string&gt;</a> 可选消息，以帮助客户端决定在协商期间使用哪个身份。
如果使用 TLS 1.3，则始终为 <code>null</code>。</li>
<li>返回: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" rel="nofollow" class="type">&lt;Object&gt;</a> 以 <code>{ psk: &lt;Buffer|TypedArray|DataView&gt;, identity: &lt;string&gt; }</code> 或 <code>null</code> 形式停止协商过程。
<code>psk</code> 必须与所选密码的摘要兼容。
<code>identity</code> 必须使用 UTF-8 编码。</li>
</ul>
<p>当协商 TLS-PSK（预共享密钥）时，此函数将使用服务器提供的可选标识 <code>hint</code> 或 <code>null</code> 调用，以防 TLS 1.3 中删除了 <code>hint</code>。
有必要为连接提供自定义 <code>tls.checkServerIdentity()</code>，因为默认情况下会尝试根据证书检查服务器的主机名/IP，但这不适用于 PSK，因为不会存在证书。
可以在 <a href="https://tools.ietf.org/html/rfc4279" rel="nofollow">RFC 4279</a> 中找到更多信息。</p>
</li>
<li>
<p><code>ALPNProtocols</code>: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" rel="nofollow" class="type">&lt;string[]&gt;</a> | <a href="../buffer.html#class-buffer" rel="nofollow" class="type">&lt;Buffer[]&gt;</a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray" rel="nofollow" class="type">&lt;TypedArray[]&gt;</a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView" rel="nofollow" class="type">&lt;DataView[]&gt;</a> | <a href="../buffer.html#class-buffer" rel="nofollow" class="type">&lt;Buffer&gt;</a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray" rel="nofollow" class="type">&lt;TypedArray&gt;</a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView" rel="nofollow" class="type">&lt;DataView&gt;</a> 字符串数组、<code>Buffer</code>、或 <code>TypedArray</code>、或 <code>DataView</code>、或包含支持的 ALPN 协议的单个 <code>Buffer</code> 或 <code>TypedArray</code> 或 <code>DataView</code>。
<code>Buffer</code> 的格式应该是 <code>[len][name][len][name]...</code>，例如 <code>'\x08http/1.1\x08http/1.0'</code>，其中 <code>len</code> 字节是下一个协议名称的长度。
传入数组通常要简单得多，例如 <code>['http/1.1', 'http/1.0']</code>。
列表中较早的协议比后面的有更高的优先级。</p>
</li>
<li>
<p><code>servername</code>: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" rel="nofollow" class="type">&lt;string&gt;</a> SNI（服务器名称指示）TLS 扩展的服务器名称。
它是所连接主机的名称，必须是主机名，而不是 IP 地址。
它可以被多宿主服务器用来选择正确的证书呈现给客户端，参见 <code>SNICallback</code> 选项到 <a href="../tls.html#tlscreateserveroptions-secureconnectionlistener"><code>tls.createServer()</code></a>。</p>
</li>
<li>
<p><code>checkServerIdentity(servername, cert)</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" rel="nofollow" class="type">&lt;Function&gt;</a> 根据证书检查服务器的主机名（或显式设置时提供的 <code>servername</code>）时要使用的回调函数（而不是内置的 <code>tls.checkServerIdentity()</code> 函数）。
如果验证失败，则这应该返回 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error" rel="nofollow" class="type">&lt;Error&gt;</a>。
如果验证了 <code>servername</code> 和 <code>cert</code>，则该方法应该返回 <code>undefined</code>。</p>
</li>
<li>
<p><code>session</code> <a href="../buffer.html#class-buffer" rel="nofollow" class="type">&lt;Buffer&gt;</a> <code>Buffer</code> 实例，包含 TLS 会话。</p>
</li>
<li>
<p><code>minDHSize</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" rel="nofollow" class="type">&lt;number&gt;</a> 接受 TLS 连接的 DH 参数的最小大小（以位为单位）。
当服务器提供大小小于 <code>minDHSize</code> 的 DH 参数时，则 TLS 连接被销毁并抛出错误。
<strong>默认值:</strong> <code>1024</code>。</p>
</li>
<li>
<p><code>highWaterMark</code>: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" rel="nofollow" class="type">&lt;number&gt;</a> 与可读流 <code>highWaterMark</code> 参数一致。
<strong>默认值:</strong> <code>16 * 1024</code>。</p>
</li>
<li>
<p><code>secureContext</code>: 使用 <a href="../tls.html#tlscreatesecurecontextoptions"><code>tls.createSecureContext()</code></a> 创建的 TLS 上下文对象。
如果 <code>secureContext</code> 未提供，则将通过将整个 <code>options</code> 对象传给 <code>tls.createSecureContext()</code> 来创建。</p>
</li>
<li>
<p><code>onread</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" rel="nofollow" class="type">&lt;Object&gt;</a> 如果缺少 <code>socket</code> 选项，则传入的数据将存储在单个 <code>buffer</code> 中，并在数据到达套接字时传递给提供的 <code>callback</code>，否则该选项将被忽略。
详见 <a href="../net.html#class-netsocket"><code>net.Socket</code></a> 的 <code>onread</code> 选项。</p>
</li>
<li>
<p>...: 如果缺少 <code>secureContext</code> 选项，则使用 <a href="../tls.html#tlscreatesecurecontextoptions"><code>tls.createSecureContext()</code></a> 选项，否则它们将被忽略。</p>
</li>
<li>
<p>...: 尚未列出的任何 <a href="../net.html#socketconnectoptions-connectlistener"><code>socket.connect()</code></a> 选项。</p>
</li>
</ul>
</li>
<li><code>callback</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" rel="nofollow" class="type">&lt;Function&gt;</a></li>
<li>返回: <a href="../tls.html#class-tlstlssocket" rel="nofollow" class="type">&lt;tls.TLSSocket&gt;</a></li>
</ul><p><code>callback</code> 函数，如果指定，则将被添加为 <a href="../tls.html#event-secureconnect"><code>'secureConnect'</code></a> 事件的监听器。</p><p class=""><code>tls.connect()</code> 返回 <a href="../tls.html#class-tlstlssocket"><code>tls.TLSSocket</code></a> 对象。</p><p class="">与 <code>https</code> API不同，<code>tls.connect()</code> 默认不启用 SNI（服务器名称指示）扩展，这可能会导致部分服务器返回错误证书或完全拒绝连接。
要启用 SNI，除了 <code>host</code> 之外，还要设置 <code>servername</code> 选项。</p><p class="">以下说明了来自 <a href="../tls.html#tlscreateserveroptions-secureconnectionlistener"><code>tls.createServer()</code></a> 的回显服务器示例的客户端：</p><pre class=""><code class="language-js"><span class="hljs-comment">// 假设回显服务器正在监听端口 8000。</span>
<span class="hljs-keyword">const</span> tls = <span class="hljs-built_in">require</span>(<span class="hljs-string">'tls'</span>);
<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);

<span class="hljs-keyword">const</span> options = {
  <span class="hljs-comment">// 仅当服务器需要客户端证书身份验证时才需要。</span>
  <span class="hljs-attr">key</span>: fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">'client-key.pem'</span>),
  <span class="hljs-attr">cert</span>: fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">'client-cert.pem'</span>),

  <span class="hljs-comment">// 仅当服务器使用自签名证书时才需要。</span>
  <span class="hljs-attr">ca</span>: [ fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">'server-cert.pem'</span>) ],

  <span class="hljs-comment">// 仅当服务器的证书不适用于 "localhost" 时才需要。</span>
  <span class="hljs-attr">checkServerIdentity</span>: <span class="hljs-function">() =&gt;</span> { <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>; },
};

<span class="hljs-keyword">const</span> socket = tls.<span class="hljs-title function_">connect</span>(<span class="hljs-number">8000</span>, options, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'client connected'</span>,
              socket.<span class="hljs-property">authorized</span> ? <span class="hljs-string">'authorized'</span> : <span class="hljs-string">'unauthorized'</span>);
  process.<span class="hljs-property">stdin</span>.<span class="hljs-title function_">pipe</span>(socket);
  process.<span class="hljs-property">stdin</span>.<span class="hljs-title function_">resume</span>();
});
socket.<span class="hljs-title function_">setEncoding</span>(<span class="hljs-string">'utf8'</span>);
socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">'data'</span>, <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data);
});
socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">'end'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'server ends connection'</span>);
});</code></pre></div>
          <div id="content_right"><div class="api_metadata">
<details class="changelog" open=""><summary>History</summary>
<table>
<tbody><tr><th>Version</th><th>Changes</th></tr>
<tr><td>v15.1.0</td>
<td><p>Added <code>onread</code> option.</p></td></tr>
<tr><td>v14.1.0, v13.14.0</td>
<td><p>The <code>highWaterMark</code> option is accepted now.</p></td></tr>
<tr><td>v13.6.0, v12.16.0</td>
<td><p>The <code>pskCallback</code> option is now supported.</p></td></tr>
<tr><td>v12.9.0</td>
<td><p>Support the <code>allowHalfOpen</code> option.</p></td></tr>
<tr><td>v12.4.0</td>
<td><p>The <code>hints</code> option is now supported.</p></td></tr>
<tr><td>v12.2.0</td>
<td><p>The <code>enableTrace</code> option is now supported.</p></td></tr>
<tr><td>v11.8.0, v10.16.0</td>
<td><p>The <code>timeout</code> option is supported now.</p></td></tr>
<tr><td>v8.0.0</td>
<td><p>The <code>lookup</code> option is supported now.</p></td></tr>
<tr><td>v8.0.0</td>
<td><p>The <code>ALPNProtocols</code> option can be a <code>TypedArray</code> or <code>DataView</code> now.</p></td></tr>
<tr><td>v5.0.0</td>
<td><p>ALPN options are supported now.</p></td></tr>
<tr><td>v5.3.0, v4.7.0</td>
<td><p>The <code>secureContext</code> option is supported now.</p></td></tr>
<tr><td>v0.11.3</td>
<td><p><span>Added in: v0.11.3</span></p></td></tr>
</tbody></table>
</details>
</div><ul>
<li><code>options</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" rel="nofollow" class="type">&lt;Object&gt;</a>
<ul>
<li>
<p><code>enableTrace</code>: See <a href="../tls.html#tlscreateserveroptions-secureconnectionlistener"><code>tls.createServer()</code></a></p>
</li>
<li>
<p><code>host</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" rel="nofollow" class="type">&lt;string&gt;</a> Host the client should connect to. <strong>Default:</strong>
<code>'localhost'</code>.</p>
</li>
<li>
<p><code>port</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" rel="nofollow" class="type">&lt;number&gt;</a> Port the client should connect to.</p>
</li>
<li>
<p><code>path</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" rel="nofollow" class="type">&lt;string&gt;</a> Creates Unix socket connection to path. If this option is
specified, <code>host</code> and <code>port</code> are ignored.</p>
</li>
<li>
<p><code>socket</code> <a href="../stream.html#class-streamduplex" rel="nofollow" class="type">&lt;stream.Duplex&gt;</a> Establish secure connection on a given socket
rather than creating a new socket. Typically, this is an instance of
<a href="../net.html#class-netsocket"><code>net.Socket</code></a>, but any <code>Duplex</code> stream is allowed.
If this option is specified, <code>path</code>, <code>host</code> and <code>port</code> are ignored,
except for certificate validation. Usually, a socket is already connected
when passed to <code>tls.connect()</code>, but it can be connected later.
Connection/disconnection/destruction of <code>socket</code> is the user's
responsibility; calling <code>tls.connect()</code> will not cause <code>net.connect()</code> to be
called.</p>
</li>
<li>
<p><code>allowHalfOpen</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type" rel="nofollow" class="type">&lt;boolean&gt;</a> If set to <code>false</code>, then the socket will
automatically end the writable side when the readable side ends. If the
<code>socket</code> option is set, this option has no effect. See the <code>allowHalfOpen</code>
option of <a href="../net.html#class-netsocket"><code>net.Socket</code></a> for details. <strong>Default:</strong> <code>false</code>.</p>
</li>
<li>
<p><code>rejectUnauthorized</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Boolean_type" rel="nofollow" class="type">&lt;boolean&gt;</a> If not <code>false</code>, the server certificate is
verified against the list of supplied CAs. An <code>'error'</code> event is emitted if
verification fails; <code>err.code</code> contains the OpenSSL error code. <strong>Default:</strong>
<code>true</code>.</p>
</li>
<li>
<p><code>pskCallback</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" rel="nofollow" class="type">&lt;Function&gt;</a></p>
<ul>
<li>hint: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" rel="nofollow" class="type">&lt;string&gt;</a> optional message sent from the server to help client
decide which identity to use during negotiation.
Always <code>null</code> if TLS 1.3 is used.</li>
<li>Returns: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" rel="nofollow" class="type">&lt;Object&gt;</a> in the form
<code>{ psk: &lt;Buffer|TypedArray|DataView&gt;, identity: &lt;string&gt; }</code>
or <code>null</code> to stop the negotiation process. <code>psk</code> must be
compatible with the selected cipher's digest.
<code>identity</code> must use UTF-8 encoding.</li>
</ul>
<p>When negotiating TLS-PSK (pre-shared keys), this function is called
with optional identity <code>hint</code> provided by the server or <code>null</code>
in case of TLS 1.3 where <code>hint</code> was removed.
It will be necessary to provide a custom <code>tls.checkServerIdentity()</code>
for the connection as the default one will try to check host name/IP
of the server against the certificate but that's not applicable for PSK
because there won't be a certificate present.
More information can be found in the <a href="https://tools.ietf.org/html/rfc4279" rel="nofollow">RFC 4279</a>.</p>
</li>
<li>
<p><code>ALPNProtocols</code>: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" rel="nofollow" class="type">&lt;string[]&gt;</a> | <a href="../buffer.html#class-buffer" rel="nofollow" class="type">&lt;Buffer[]&gt;</a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray" rel="nofollow" class="type">&lt;TypedArray[]&gt;</a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView" rel="nofollow" class="type">&lt;DataView[]&gt;</a> | <a href="../buffer.html#class-buffer" rel="nofollow" class="type">&lt;Buffer&gt;</a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray" rel="nofollow" class="type">&lt;TypedArray&gt;</a> | <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView" rel="nofollow" class="type">&lt;DataView&gt;</a>
An array of strings, <code>Buffer</code>s or <code>TypedArray</code>s or <code>DataView</code>s, or a
single <code>Buffer</code> or <code>TypedArray</code> or <code>DataView</code> containing the supported ALPN
protocols. <code>Buffer</code>s should have the format <code>[len][name][len][name]...</code>
e.g. <code>'\x08http/1.1\x08http/1.0'</code>, where the <code>len</code> byte is the length of the
next protocol name. Passing an array is usually much simpler, e.g.
<code>['http/1.1', 'http/1.0']</code>. Protocols earlier in the list have higher
preference than those later.</p>
</li>
<li>
<p><code>servername</code>: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" rel="nofollow" class="type">&lt;string&gt;</a> Server name for the SNI (Server Name Indication) TLS
extension. It is the name of the host being connected to, and must be a host
name, and not an IP address. It can be used by a multi-homed server to
choose the correct certificate to present to the client, see the
<code>SNICallback</code> option to <a href="../tls.html#tlscreateserveroptions-secureconnectionlistener"><code>tls.createServer()</code></a>.</p>
</li>
<li>
<p><code>checkServerIdentity(servername, cert)</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" rel="nofollow" class="type">&lt;Function&gt;</a> A callback function
to be used (instead of the builtin <code>tls.checkServerIdentity()</code> function)
when checking the server's host name (or the provided <code>servername</code> when
explicitly set) against the certificate. This should return an <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error" rel="nofollow" class="type">&lt;Error&gt;</a> if
verification fails. The method should return <code>undefined</code> if the <code>servername</code>
and <code>cert</code> are verified.</p>
</li>
<li>
<p><code>session</code> <a href="../buffer.html#class-buffer" rel="nofollow" class="type">&lt;Buffer&gt;</a> A <code>Buffer</code> instance, containing TLS session.</p>
</li>
<li>
<p><code>minDHSize</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" rel="nofollow" class="type">&lt;number&gt;</a> Minimum size of the DH parameter in bits to accept a
TLS connection. When a server offers a DH parameter with a size less
than <code>minDHSize</code>, the TLS connection is destroyed and an error is thrown.
<strong>Default:</strong> <code>1024</code>.</p>
</li>
<li>
<p><code>highWaterMark</code>: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#Number_type" rel="nofollow" class="type">&lt;number&gt;</a> Consistent with the readable stream <code>highWaterMark</code> parameter.
<strong>Default:</strong> <code>16 * 1024</code>.</p>
</li>
<li>
<p><code>secureContext</code>: TLS context object created with
<a href="../tls.html#tlscreatesecurecontextoptions"><code>tls.createSecureContext()</code></a>. If a <code>secureContext</code> is <em>not</em> provided, one
will be created by passing the entire <code>options</code> object to
<code>tls.createSecureContext()</code>.</p>
</li>
<li>
<p><code>onread</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object" rel="nofollow" class="type">&lt;Object&gt;</a> If the <code>socket</code> option is missing, incoming data is
stored in a single <code>buffer</code> and passed to the supplied <code>callback</code> when
data arrives on the socket, otherwise the option is ignored. See the
<code>onread</code> option of <a href="../net.html#class-netsocket"><code>net.Socket</code></a> for details.</p>
</li>
<li>
<p>...: <a href="../tls.html#tlscreatesecurecontextoptions"><code>tls.createSecureContext()</code></a> options that are used if the
<code>secureContext</code> option is missing, otherwise they are ignored.</p>
</li>
<li>
<p>...: Any <a href="../net.html#socketconnectoptions-connectlistener"><code>socket.connect()</code></a> option not already listed.</p>
</li>
</ul>
</li>
<li><code>callback</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function" rel="nofollow" class="type">&lt;Function&gt;</a></li>
<li>Returns: <a href="../tls.html#class-tlstlssocket" rel="nofollow" class="type">&lt;tls.TLSSocket&gt;</a></li>
</ul><p>The <code>callback</code> function, if specified, will be added as a listener for the
<a href="../tls.html#event-secureconnect"><code>'secureConnect'</code></a> event.</p><p><code>tls.connect()</code> returns a <a href="../tls.html#class-tlstlssocket"><code>tls.TLSSocket</code></a> object.</p><p>Unlike the <code>https</code> API, <code>tls.connect()</code> does not enable the
SNI (Server Name Indication) extension by default, which may cause some
servers to return an incorrect certificate or reject the connection
altogether. To enable SNI, set the <code>servername</code> option in addition
to <code>host</code>.</p><p>The following illustrates a client for the echo server example from
<a href="../tls.html#tlscreateserveroptions-secureconnectionlistener"><code>tls.createServer()</code></a>:</p><pre><code class="language-js"><span class="hljs-comment">// Assumes an echo server that is listening on port 8000.</span>
<span class="hljs-keyword">const</span> tls = <span class="hljs-built_in">require</span>(<span class="hljs-string">'tls'</span>);
<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);

<span class="hljs-keyword">const</span> options = {
  <span class="hljs-comment">// Necessary only if the server requires client certificate authentication.</span>
  <span class="hljs-attr">key</span>: fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">'client-key.pem'</span>),
  <span class="hljs-attr">cert</span>: fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">'client-cert.pem'</span>),

  <span class="hljs-comment">// Necessary only if the server uses a self-signed certificate.</span>
  <span class="hljs-attr">ca</span>: [ fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">'server-cert.pem'</span>) ],

  <span class="hljs-comment">// Necessary only if the server's cert isn't for "localhost".</span>
  <span class="hljs-attr">checkServerIdentity</span>: <span class="hljs-function">() =&gt;</span> { <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>; },
};

<span class="hljs-keyword">const</span> socket = tls.<span class="hljs-title function_">connect</span>(<span class="hljs-number">8000</span>, options, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'client connected'</span>,
              socket.<span class="hljs-property">authorized</span> ? <span class="hljs-string">'authorized'</span> : <span class="hljs-string">'unauthorized'</span>);
  process.<span class="hljs-property">stdin</span>.<span class="hljs-title function_">pipe</span>(socket);
  process.<span class="hljs-property">stdin</span>.<span class="hljs-title function_">resume</span>();
});
socket.<span class="hljs-title function_">setEncoding</span>(<span class="hljs-string">'utf8'</span>);
socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">'data'</span>, <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data);
});
socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">'end'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'server ends connection'</span>);
});</code></pre></div>
          <div></div>
        </div>

        <!-- <div id="biz_item" class="biz_wrap" data-biz="api_item">
          <a target="_blank" class="biz_link">
            <img class="biz_img" />
          </a>
        </div> -->
      </div>
    </div>
  </div>
  
  <div id="wxpaycode_box" style="display: none;">
    <div id="wxpaycode_img_box">
      <div id="wxpaycode_vip_tips">
        因经营维护成本巨大，
        <br>为了能提供更高质量的中文文档，
        <br>即日起将只对VIP会员开放。
        <br>扫码成为VIP会员，会员费用为<span id="wxpaycode_vip_money">199</span>元/年
      </div>
      <img id="wxpaycode_img">
    </div>
  </div>
  
  
  



    <script src="../../api/static/inject.js" defer=""></script></body></html>