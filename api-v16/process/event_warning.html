<!DOCTYPE html><html lang="zh-CN"><head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>'warning' 事件 | Node.js API 文档</title>
  
  

    <link href="../../api/static/inject.css" rel="stylesheet"><link rel="icon" sizes="32x32" type="image/png" href="../../api/static/favicon.png"></head>

<body class="alt apidoc" id="page_api_item">
  <div id="api-section-process">
    <div id="content" class="clearfix">

      <div id="column1" data-id="__ID__" class="interior">
        <header>
          <h1>'warning' 事件</h1>
          <div id="gtoc">
            <ul>
              <li>v16.16.0</li>
              <li>
                <a href="../process.html#process_event_warning" name="toc">返回上层文档</a>
              </li>

              <li class="picker-header">
    <a href="#">
        <span class="collapsed-arrow">►</span><span class="expanded-arrow">▼</span>
        其他版本
      </a>
    <div class="picker"><ol id="alt-docs">
    <li><a href="../../api/process/event_warning.html">18.6.0</a></li><li><a href="">16.16.0</a></li><li><a href="../../api-v14/process/event_warning.html">14.20.0</a></li>
</ol></div>
  </li>

              <li>
                <a href="http://api.nodejs.cn/" class="link-to-search">搜索</a>
              </li>
              <li>
                
                
              </li>

              <!-- <li>
                <a href="https://github.com/nodejscn/node-api-cn/edit/master/process/#event-warning.md" rel="nofollow">提交修改</a>
              </li> -->
              <!-- <li>
                <a href="/gzh/">公众号</a>
              </li> -->
              <!-- <li class="biz_wrap" data-biz="api_item_nav">
                <a target="_blank" class="biz_title biz_link"></a>
              </li> -->
            </ul>
          </div>
          <hr>
        </header>

        <div id="apicontent">
          <div id="content_left"><div class="api_metadata">
<span>新增于: v6.0.0</span>
</div><ul class="">
<li><code>warning</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error" rel="nofollow" class="type">&lt;Error&gt;</a> 警告的主要属性是：
<ul>
<li><code>name</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" rel="nofollow" class="type">&lt;string&gt;</a> 警告的名称。 <strong>默认值:</strong> <code>'Warning'</code>。</li>
<li><code>message</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" rel="nofollow" class="type">&lt;string&gt;</a> 系统提供的警告描述。</li>
<li><code>stack</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" rel="nofollow" class="type">&lt;string&gt;</a> 代码中发出警告的位置的堆栈跟踪。</li>
</ul>
</li>
</ul><p>每当 Node.js 触发进程警告时，则会触发 <code>'warning'</code> 事件。</p><p class="">进程警告类似于错误，因为其描述了引起用户注意的异常情况。
但是，警告不是正常 Node.js 和 JavaScript 错误处理流程的一部分。
Node.js 可以在检测到可能导致次优应用程序性能、错误或安全漏洞的不良编码实践时触发警告。</p><pre class="with-35-chars"><input class="js-flavor-selector" type="checkbox" checked="" aria-label="Show modern ES modules syntax"><code class="language-js mjs"><span class="hljs-keyword">import</span> process <span class="hljs-keyword">from</span> <span class="hljs-string">'process'</span>;

process.<span class="hljs-title function_">on</span>(<span class="hljs-string">'warning'</span>, <span class="hljs-function">(<span class="hljs-params">warning</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(warning.<span class="hljs-property">name</span>);    <span class="hljs-comment">// 打印警告名称</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(warning.<span class="hljs-property">message</span>); <span class="hljs-comment">// 打印警告信息</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(warning.<span class="hljs-property">stack</span>);   <span class="hljs-comment">// 打印堆栈跟踪</span>
});</code><code class="language-js cjs"><span class="hljs-keyword">const</span> process = <span class="hljs-built_in">require</span>(<span class="hljs-string">'process'</span>);

process.<span class="hljs-title function_">on</span>(<span class="hljs-string">'warning'</span>, <span class="hljs-function">(<span class="hljs-params">warning</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(warning.<span class="hljs-property">name</span>);    <span class="hljs-comment">// 打印警告名称</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(warning.<span class="hljs-property">message</span>); <span class="hljs-comment">// 打印警告信息</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(warning.<span class="hljs-property">stack</span>);   <span class="hljs-comment">// 打印堆栈跟踪</span>
});</code></pre><p class="">默认情况下，Node.js 会将进程警告打印到 <code>stderr</code>。
<code>--no-warnings</code> 命令行选项可用于抑制默认控制台输出，但 <code>'warning'</code> 事件仍将由 <code>process</code> 对象触发。</p><p class="">以下示例说明了在向事件添加过多监听器时打印到 <code>stderr</code> 的警告：</p><pre class=""><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">node</span>
<span class="hljs-meta prompt_">&gt; </span><span class="language-bash">events.defaultMaxListeners = 1;</span>
<span class="hljs-meta prompt_">&gt; </span><span class="language-bash">process.on(<span class="hljs-string">'foo'</span>, () =&gt; {});</span>
<span class="hljs-meta prompt_">&gt; </span><span class="language-bash">process.on(<span class="hljs-string">'foo'</span>, () =&gt; {});</span>
<span class="hljs-meta prompt_">&gt; </span><span class="language-bash">(node:38638) MaxListenersExceededWarning: Possible EventEmitter memory leak</span>
detected. 2 foo listeners added. Use emitter.setMaxListeners() to increase limit</code></pre><p class="">相比之下，以下示例关闭默认警告输出并向 <code>'warning'</code> 事件添加自定义句柄：</p><pre class=""><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">node --no-warnings</span>
<span class="hljs-meta prompt_">&gt; </span><span class="language-bash">const p = process.on(<span class="hljs-string">'warning'</span>, (warning) =&gt; console.warn(<span class="hljs-string">'Do not do that!'</span>));</span>
<span class="hljs-meta prompt_">&gt; </span><span class="language-bash">events.defaultMaxListeners = 1;</span>
<span class="hljs-meta prompt_">&gt; </span><span class="language-bash">process.on(<span class="hljs-string">'foo'</span>, () =&gt; {});</span>
<span class="hljs-meta prompt_">&gt; </span><span class="language-bash">process.on(<span class="hljs-string">'foo'</span>, () =&gt; {});</span>
<span class="hljs-meta prompt_">&gt; </span><span class="language-bash">Do not <span class="hljs-keyword">do</span> that!</span></code></pre><p class=""><code>--trace-warnings</code> 命令行选项可用于使警告的默认控制台输出包括警告的完整堆栈跟踪。</p><p class="">使用 <code>--throw-deprecation</code> 命令行标志启动 Node.js 将导致自定义弃用警告作为异常抛出。</p><p class="">使用 <code>--trace-deprecation</code> 命令行标志将导致自定义弃用与堆栈跟踪一起打印到 <code>stderr</code>。</p><p class="">使用 <code>--no-deprecation</code> 命令行标志将抑制自定义弃用的所有报告。</p><p class=""><code>*-deprecation</code> 命令行标志仅影响使用名称 <code>'DeprecationWarning'</code> 的警告。</p></div>
          <div id="content_right"><div class="api_metadata">
<span>Added in: v6.0.0</span>
</div><ul>
<li><code>warning</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error" rel="nofollow" class="type">&lt;Error&gt;</a> Key properties of the warning are:
<ul>
<li><code>name</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" rel="nofollow" class="type">&lt;string&gt;</a> The name of the warning. <strong>Default:</strong> <code>'Warning'</code>.</li>
<li><code>message</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" rel="nofollow" class="type">&lt;string&gt;</a> A system-provided description of the warning.</li>
<li><code>stack</code> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures#String_type" rel="nofollow" class="type">&lt;string&gt;</a> A stack trace to the location in the code where the warning
was issued.</li>
</ul>
</li>
</ul><p>The <code>'warning'</code> event is emitted whenever Node.js emits a process warning.</p><p>A process warning is similar to an error in that it describes exceptional
conditions that are being brought to the user's attention. However, warnings
are not part of the normal Node.js and JavaScript error handling flow.
Node.js can emit warnings whenever it detects bad coding practices that could
lead to sub-optimal application performance, bugs, or security vulnerabilities.</p><pre><input class="js-flavor-selector" type="checkbox" checked="" aria-label="Show modern ES modules syntax"><code class="language-js mjs"><span class="hljs-keyword">import</span> process <span class="hljs-keyword">from</span> <span class="hljs-string">'process'</span>;

process.<span class="hljs-title function_">on</span>(<span class="hljs-string">'warning'</span>, <span class="hljs-function">(<span class="hljs-params">warning</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(warning.<span class="hljs-property">name</span>);    <span class="hljs-comment">// Print the warning name</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(warning.<span class="hljs-property">message</span>); <span class="hljs-comment">// Print the warning message</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(warning.<span class="hljs-property">stack</span>);   <span class="hljs-comment">// Print the stack trace</span>
});</code><code class="language-js cjs"><span class="hljs-keyword">const</span> process = <span class="hljs-built_in">require</span>(<span class="hljs-string">'process'</span>);

process.<span class="hljs-title function_">on</span>(<span class="hljs-string">'warning'</span>, <span class="hljs-function">(<span class="hljs-params">warning</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(warning.<span class="hljs-property">name</span>);    <span class="hljs-comment">// Print the warning name</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(warning.<span class="hljs-property">message</span>); <span class="hljs-comment">// Print the warning message</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(warning.<span class="hljs-property">stack</span>);   <span class="hljs-comment">// Print the stack trace</span>
});</code></pre><p>By default, Node.js will print process warnings to <code>stderr</code>. The <code>--no-warnings</code>
command-line option can be used to suppress the default console output but the
<code>'warning'</code> event will still be emitted by the <code>process</code> object.</p><p>The following example illustrates the warning that is printed to <code>stderr</code> when
too many listeners have been added to an event:</p><pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">node</span>
<span class="hljs-meta prompt_">&gt; </span><span class="language-bash">events.defaultMaxListeners = 1;</span>
<span class="hljs-meta prompt_">&gt; </span><span class="language-bash">process.on(<span class="hljs-string">'foo'</span>, () =&gt; {});</span>
<span class="hljs-meta prompt_">&gt; </span><span class="language-bash">process.on(<span class="hljs-string">'foo'</span>, () =&gt; {});</span>
<span class="hljs-meta prompt_">&gt; </span><span class="language-bash">(node:38638) MaxListenersExceededWarning: Possible EventEmitter memory leak</span>
detected. 2 foo listeners added. Use emitter.setMaxListeners() to increase limit</code></pre><p>In contrast, the following example turns off the default warning output and
adds a custom handler to the <code>'warning'</code> event:</p><pre><code class="language-console"><span class="hljs-meta prompt_">$ </span><span class="language-bash">node --no-warnings</span>
<span class="hljs-meta prompt_">&gt; </span><span class="language-bash">const p = process.on(<span class="hljs-string">'warning'</span>, (warning) =&gt; console.warn(<span class="hljs-string">'Do not do that!'</span>));</span>
<span class="hljs-meta prompt_">&gt; </span><span class="language-bash">events.defaultMaxListeners = 1;</span>
<span class="hljs-meta prompt_">&gt; </span><span class="language-bash">process.on(<span class="hljs-string">'foo'</span>, () =&gt; {});</span>
<span class="hljs-meta prompt_">&gt; </span><span class="language-bash">process.on(<span class="hljs-string">'foo'</span>, () =&gt; {});</span>
<span class="hljs-meta prompt_">&gt; </span><span class="language-bash">Do not <span class="hljs-keyword">do</span> that!</span></code></pre><p>The <code>--trace-warnings</code> command-line option can be used to have the default
console output for warnings include the full stack trace of the warning.</p><p>Launching Node.js using the <code>--throw-deprecation</code> command-line flag will
cause custom deprecation warnings to be thrown as exceptions.</p><p>Using the <code>--trace-deprecation</code> command-line flag will cause the custom
deprecation to be printed to <code>stderr</code> along with the stack trace.</p><p>Using the <code>--no-deprecation</code> command-line flag will suppress all reporting
of the custom deprecation.</p><p>The <code>*-deprecation</code> command-line flags only affect warnings that use the name
<code>'DeprecationWarning'</code>.</p></div>
          <div></div>
        </div>

        <!-- <div id="biz_item" class="biz_wrap" data-biz="api_item">
          <a target="_blank" class="biz_link">
            <img class="biz_img" />
          </a>
        </div> -->
      </div>
    </div>
  </div>
  
  <div id="wxpaycode_box" style="display: none;">
    <div id="wxpaycode_img_box">
      <div id="wxpaycode_vip_tips">
        因经营维护成本巨大，
        <br>为了能提供更高质量的中文文档，
        <br>即日起将只对VIP会员开放。
        <br>扫码成为VIP会员，会员费用为<span id="wxpaycode_vip_money">199</span>元/年
      </div>
      <img id="wxpaycode_img">
    </div>
  </div>
  
  
  



    <script src="../../api/static/inject.js" defer=""></script></body></html>